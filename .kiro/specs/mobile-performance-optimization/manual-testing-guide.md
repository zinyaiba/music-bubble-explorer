# Manual Testing Guide - Animation Control

このガイドは、モバイルパフォーマンス最適化機能の手動テストを実施するための手順書です。

## テスト環境

- **ブラウザ**: Chrome, Safari, Firefox
- **デバイス**: デスクトップ、スマートフォン（実機推奨）
- **開発サーバー**: `npm run dev` で起動

## テストケース

### 1. ダイアログ開閉時のアニメーション制御

#### 1.1 DetailModal（シャボン玉詳細）でのテスト

**手順:**
1. アプリケーションを起動し、シャボン玉が動いていることを確認
2. 任意のシャボン玉をクリック/タップして詳細モーダルを開く
3. シャボン玉のアニメーションが停止することを確認
4. モーダルを閉じる（×ボタンまたはESCキー）
5. シャボン玉のアニメーションが再開することを確認

**期待結果:**
- ✅ モーダルを開いた瞬間にシャボン玉のアニメーションが停止する
- ✅ モーダルを閉じた瞬間にシャボン玉のアニメーションが再開する
- ✅ アニメーションの停止/再開がスムーズで違和感がない

#### 1.2 StandardLayout（タグ一覧、タグ登録）でのテスト

**手順:**
1. ナビゲーションから「タグ一覧」を開く
2. シャボン玉のアニメーションが停止することを確認
3. 「タグ一覧」を閉じる
4. シャボン玉のアニメーションが再開することを確認
5. 「タグ登録」でも同様にテスト

**期待結果:**
- ✅ タグ一覧/タグ登録を開いた瞬間にシャボン玉のアニメーションが停止する
- ✅ 画面を閉じた瞬間にシャボン玉のアニメーションが再開する

#### 1.3 複数回の開閉テスト

**手順:**
1. シャボン玉詳細を開く → 閉じる → 開く → 閉じる（3回繰り返す）
2. 各開閉でアニメーションが正しく制御されることを確認

**期待結果:**
- ✅ 何度開閉してもアニメーション制御が正常に動作する
- ✅ メモリリークやパフォーマンス低下が発生しない

### 2. アイドル状態の検出

#### 2.1 30秒間操作なしでアニメーション停止

**手順:**
1. アプリケーションを起動
2. 30秒間、マウス、キーボード、タッチ、スクロールなどの操作を一切行わない
3. 30秒経過後、シャボン玉のアニメーションが停止することを確認

**期待結果:**
- ✅ 30秒経過後にシャボン玉のアニメーションが停止する
- ✅ アニメーションの停止がスムーズで違和感がない

**デバッグ方法:**
```javascript
// ブラウザのコンソールで以下を実行して、アイドルタイマーを短縮できます
// （テスト用に5秒に変更する例）
// 注: 実装を一時的に変更する必要があります
```

#### 2.2 マウス移動でアイドル状態から復帰

**手順:**
1. 30秒間操作せずにアイドル状態にする
2. マウスを動かす
3. シャボン玉のアニメーションが再開することを確認

**期待結果:**
- ✅ マウス移動でアニメーションが即座に再開する

#### 2.3 クリックでアイドル状態から復帰

**手順:**
1. 30秒間操作せずにアイドル状態にする
2. 画面上の任意の場所をクリック
3. シャボン玉のアニメーションが再開することを確認

**期待結果:**
- ✅ クリックでアニメーションが即座に再開する

#### 2.4 タッチでアイドル状態から復帰（モバイル）

**手順:**
1. スマートフォンで30秒間操作せずにアイドル状態にする
2. 画面をタッチ
3. シャボン玉のアニメーションが再開することを確認

**期待結果:**
- ✅ タッチでアニメーションが即座に再開する

#### 2.5 スクロールでアイドル状態から復帰

**手順:**
1. 30秒間操作せずにアイドル状態にする
2. ページをスクロール
3. シャボン玉のアニメーションが再開することを確認

**期待結果:**
- ✅ スクロールでアニメーションが即座に再開する

#### 2.6 キーボード入力でアイドル状態から復帰

**手順:**
1. 30秒間操作せずにアイドル状態にする
2. 任意のキーを押す
3. シャボン玉のアニメーションが再開することを確認

**期待結果:**
- ✅ キーボード入力でアニメーションが即座に再開する

### 3. ダイアログとアイドル状態の相互作用

#### 3.1 ダイアログが開いている間はアイドルタイマーが動作しない

**手順:**
1. シャボン玉詳細モーダルを開く
2. 30秒以上待つ（モーダルは開いたまま）
3. モーダルを閉じる
4. シャボン玉のアニメーションが即座に再開することを確認（アイドル状態にならない）

**期待結果:**
- ✅ ダイアログが開いている間はアイドルタイマーがカウントされない
- ✅ ダイアログを閉じた直後はアニメーションが再開される

#### 3.2 ダイアログを閉じた後にアイドルタイマーがリセットされる

**手順:**
1. シャボン玉詳細モーダルを開く
2. 30秒以上待つ
3. モーダルを閉じる
4. さらに30秒待つ
5. アイドル状態になることを確認

**期待結果:**
- ✅ ダイアログを閉じた時点でアイドルタイマーがリセットされる
- ✅ ダイアログを閉じてから30秒後にアイドル状態になる

### 4. パフォーマンステスト（モバイル実機）

#### 4.1 発熱テスト

**手順:**
1. スマートフォンでアプリケーションを開く
2. 5分間放置（アイドル状態になる）
3. デバイスの温度を体感で確認
4. 比較: アイドル状態前後での発熱の違いを確認

**期待結果:**
- ✅ アイドル状態になると発熱が抑えられる
- ✅ ダイアログを開いている間も発熱が抑えられる

#### 4.2 バッテリー消費テスト

**手順:**
1. スマートフォンのバッテリー残量を確認
2. アプリケーションを30分間表示（アイドル状態を含む）
3. バッテリー消費量を確認
4. 比較: 最適化前後でのバッテリー消費の違いを確認

**期待結果:**
- ✅ アイドル状態でのバッテリー消費が削減される
- ✅ ダイアログ表示中のバッテリー消費が削減される

**注意:** 正確な計測には、バッテリー計測ツール（Android: Battery Historian、iOS: Xcode Instruments）の使用を推奨

### 5. ブラウザ互換性テスト

#### 5.1 Chrome

- ✅ すべての機能が正常に動作する
- ✅ アニメーションの停止/再開がスムーズ

#### 5.2 Safari（iOS）

- ✅ すべての機能が正常に動作する
- ✅ タッチイベントが正しく検出される

#### 5.3 Firefox

- ✅ すべての機能が正常に動作する
- ✅ アニメーションの停止/再開がスムーズ

## デバッグツール

### ブラウザコンソールでの確認

```javascript
// アニメーション状態を確認
// （開発者ツールのコンソールで実行）

// 1. Reactコンポーネントの状態を確認（React DevTools使用）
// 2. requestAnimationFrameの呼び出し回数を確認
let frameCount = 0
const originalRAF = window.requestAnimationFrame
window.requestAnimationFrame = function(...args) {
  frameCount++
  console.log('RAF called:', frameCount)
  return originalRAF.apply(this, args)
}

// 3. アイドルタイマーの動作を確認（実装にconsole.logを追加）
```

### Chrome DevTools Performance

1. Performance タブを開く
2. 記録を開始
3. ダイアログを開閉、アイドル状態を作る
4. 記録を停止
5. CPU使用率、FPSを確認

**期待結果:**
- ダイアログ開閉時にrequestAnimationFrameの呼び出しが停止する
- アイドル状態でCPU使用率が低下する

## テスト結果の記録

| テストケース | 結果 | 備考 |
|------------|------|------|
| 1.1 DetailModalでのアニメーション制御 | ✅ / ❌ | |
| 1.2 StandardLayoutでのアニメーション制御 | ✅ / ❌ | |
| 1.3 複数回の開閉テスト | ✅ / ❌ | |
| 2.1 30秒間操作なしでアニメーション停止 | ✅ / ❌ | |
| 2.2 マウス移動で復帰 | ✅ / ❌ | |
| 2.3 クリックで復帰 | ✅ / ❌ | |
| 2.4 タッチで復帰 | ✅ / ❌ | |
| 2.5 スクロールで復帰 | ✅ / ❌ | |
| 2.6 キーボード入力で復帰 | ✅ / ❌ | |
| 3.1 ダイアログ中はアイドルタイマー無効 | ✅ / ❌ | |
| 3.2 ダイアログ閉じた後タイマーリセット | ✅ / ❌ | |
| 4.1 発熱テスト | ✅ / ❌ | |
| 4.2 バッテリー消費テスト | ✅ / ❌ | |
| 5.1 Chrome互換性 | ✅ / ❌ | |
| 5.2 Safari互換性 | ✅ / ❌ | |
| 5.3 Firefox互換性 | ✅ / ❌ | |

## 既知の問題

（テスト中に発見した問題をここに記録）

## 次のステップ

すべてのテストケースが✅になったら、タスク6を完了としてマークしてください。
