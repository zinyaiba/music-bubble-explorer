# Implementation Plan

- [x] 1. プロジェクト基盤とデータ構造の設定
  - React.jsプロジェクトの初期化とディレクトリ構造の作成
  - TypeScript設定とESLint/Prettierの設定
  - 楽曲データのJSON構造定義とサンプルデータ作成
  - _Requirements: 5.1, 5.2, 5.3_

- [x] 2. 基本データモデルとユーティリティの実装
  - Song、Person、Tag、MusicDatabaseインターフェースの定義
  - データ読み込みとパース機能の実装
  - 楽曲と人物、タグの関連性計算ロジックの実装
  - MusicDataServiceの実装
  - _Requirements: 6.1, 6.4, 8.1, 8.3_

- [x] 2.1 データモデルのユニットテスト作成*
  - データパース機能のテスト
  - 関連性計算ロジックのテスト
  - データバリデーション機能のテスト
  - _Requirements: 5.1, 5.2, 5.3_

- [x] 3. シャボン玉エンティティとマネージャーの実装
  - BubbleEntityクラスの実装（物理状態管理、改善されたライフサイクル）
  - BubbleManagerサービスクラスの実装
  - シャボン玉サイズ計算アルゴリズムの実装
  - 物理エンジン（重力、衝突、境界処理）の実装
  - タグタイプのシャボン玉対応
  - _Requirements: 1.4, 2.4, 6.1, 6.2, 7.1, 7.4_

- [x] 3.1 シャボン玉ロジックのユニットテスト*
  - サイズ計算アルゴリズムのテスト
  - BubbleManagerの各メソッドのテスト
  - 物理計算ロジックのテスト
  - _Requirements: 1.4, 2.4_

- [x] 4. パステルカラーシステムとテーマの実装
  - CSS変数によるカラーパレットの定義
  - Styled Componentsのテーマプロバイダー設定
  - シャボン玉の色選択ロジックの実装
  - _Requirements: 6.1, 6.2, 6.4_

- [x] 5. BubbleCanvasコンポーネントの実装

  - HTML5 Canvasを使用したシャボン玉描画コンポーネント
  - シャボン玉の円形描画とグラデーション効果
  - Canvas上でのクリック座標検出とイベント処理
  - _Requirements: 1.1, 1.2, 1.5, 3.1_

- [x] 6. アニメーションシステムの統合

  - RequestAnimationFrameによるアニメーションループ
  - BubbleManagerとCanvasの連携
  - シャボン玉の浮遊アニメーションの実装
  - _Requirements: 1.3, 2.1, 2.2, 2.3_



- [x] 7. シャボン玉のライフサイクルアニメーションの実装

  - 出現アニメーション（フェードイン、スケールアップ）
  - 消失アニメーション（フェードアウト、スケールダウン）
  - クリック時の拡大アニメーション
  - _Requirements: 2.1, 2.2, 2.3, 3.4_

- [x] 8. 詳細情報表示モーダルの実装

  - DetailModalコンポーネントの作成
  - 楽曲詳細表示（作詞家・作曲家・編曲家一覧）
  - 人物詳細表示（関連楽曲一覧）
  - モーダルの開閉アニメーション
  - _Requirements: 3.2, 3.3, 3.4_

- [x] 9. メインアプリケーションコンポーネントの統合

  - App.tsxでのBubbleCanvasとModalの統合
  - MusicDataServiceとBubbleManagerの初期化

  - 全体的なレイアウトとスタイリング
  - _Requirements: 1.1, 1.2, 1.3_

- [x] 10. レスポンシブデザインの実装

  - CSS Grid/Flexboxによる基本レイアウト
  - メディアクエリによるブレークポイント設定
  - モバイル向けタッチ操作の最適化
  - 画面サイズに応じたシャボン玉数の調整
  - _Requirements: 4.1, 4.2, 4.3, 4.4_


- [x] 11. パフォーマンス最適化の実装


  - 仮想化による画面外シャボン玉の描画スキップ

  - React.memoとuseMemoによる再レンダリング最適化
  - Canvas描画の最適化
  - _Requirements: 1.4, 2.1, 4.4_

- [x] 12. エラーハンドリングとフォールバック機能の実装

  - データ読み込みエラーの処理
  - Canvas描画エラーのキャッチと復旧
  - ネットワークエラー時のフォールバック表示
  - _Requirements: 5.1, 5.2_

- [x] 12.1 エラーハンドリングのテスト*


  - 各種エラーケースのテスト
  - フォールバック機能の動作確認
  - _Requirements: 5.1, 5.2_



- [x] 13. 最終的な統合とポリッシュ

  - 全コンポーネントの統合とテスト
  - アニメーションの微調整とパフォーマンス確認
  - アクセシビリティ対応（キーボードナビゲーション、ARIA属性）
  - 300曲データでの動作確認
  - _Requirements: 1.1, 1.2, 1.3, 2.1, 2.2, 2.3, 3.1, 3.2, 3.3, 4.1, 4.2, 5.2_

- [x] 13.1 統合テストとE2Eテストの実装*


  - コンポーネント間の相互作用テスト
  - ユーザーフロー全体のE2Eテスト
  - パフォーマンステスト（大量データ、長時間実行）
  - _Requirements: 1.1, 2.1, 3.1, 4.1, 5.2_
- [x] 14. データ永続化システムの実装

  - LocalStorageを使用したDataManagerクラスの実装
  - 楽曲データの保存・読み込み機能
  - データのインポート・エクスポート機能
  - データバージョン管理とマイグレーション
  - _Requirements: 5.1, 5.3, 8.1, 8.4_

- [x] 15. 楽曲登録フォームの実装

  - SongRegistrationFormコンポーネントの作成
  - フォーム入力値の検証とエラー表示
  - タグのカンマ区切り入力対応
  - 楽曲データの保存処理との連携

  - フォームのレスポンシブデザイン
  - _Requirements: 5.1, 5.2, 5.3, 5.4, 5.5_

- [x] 16. タグシステムの実装

  - TagManagerクラスの実装
  - タグ専用のシャボン玉スタイリング

  - タグクリック時の関連楽曲表示機能
  - タグの人気度に基づくサイズ計算

  - _Requirements: 6.1, 6.2, 6.3, 6.4_
- [x] 17. シャボン玉アニメーションの改善

  - 5-10秒のライフサイクル管理の実装
  - 60FPSスムーズアニメーションの最適化
  - GPU加速（transform3d）の適用
  - ベジェ曲線による自然な軌道の実装
  - パーリンノイズによる微細な揺れの追加
  - _Requirements: 7.1, 7.2, 7.3, 7.4, 7.5_

- [x] 18. UIの統合と改善

  - 楽曲登録フォームの表示・非表示切り替え
  - タグシャボン玉の詳細モーダル対応
  - 全体的なレイアウトの調整
  - アクセシビリティの向上

  - _Requirements: 5.1, 6.3, 10.1, 10.2_


- [x] 19. GitHub Pages対応とPWA化

  - Vite設定のGitHub Pages対応
  - Service Workerの実装
  - PWAマニフェストファイルの作成
  - オフライン対応の実装
  - モバイルアプリライクな体験の提供
  - _Requirements: 9.1, 9.2, 9.3, 9.4_

- [x] 20. 最終的な統合とテスト

  - 全新機能の統合テスト
  - モバイルデバイスでの動作確認
  - パフォーマンス最適化の検証
  - GitHub Pagesでのデプロイテスト
  - _Requirements: 5.1, 6.1, 7.1, 9.1, 10.1_

- [x] 20.1 新機能のユニットテスト

  - DataManagerのテスト
  - SongRegistrationFormのテスト
  - TagManagerのテスト
  - 改善されたアニメーションのテスト
  - _Requirements: 5.1, 6.1, 7.1_

- [x] 21. 楽曲編集・削除機能の実装

  - SongManagementコンポーネントの作成
  - 楽曲一覧表示と選択機能
  - 楽曲編集フォームの実装
  - 削除確認ダイアログの実装
  - DataManagerのCRUD操作との連携
  - _Requirements: 11.1, 11.2, 11.3, 11.4, 11.5_

- [x] 22. 個別タグ入力システムの実装

  - TagInputコンポーネントの作成
  - 動的タグフィールドの追加・削除機能
  - 既存タグの候補表示機能
  - タグの重複チェックと統合機能
  - SongRegistrationFormとの統合
  - _Requirements: 12.1, 12.2, 12.3, 12.4, 12.5_


- [x] 23. タグのハッシュタグ表示機能の実装

  - BubbleManagerのformatBubbleText関数実装
  - タグシャボン玉の表示名に#プレフィックス追加
  - タグの視覚的区別の強化
  - DetailModalでのハッシュタグ表示対応
  - _Requirements: 6.3_

- [x] 24. シャボン玉文字表示の改善

  - 動的フォントサイズ計算の実装
  - 文字の色コントラスト改善
  - 文字の縁取り効果追加
  - 最小・最大フォントサイズの設定
  - 長いテキストの省略表示対応
  - _Requirements: 10.5_

- [x] 25. UI統合と全体調整

  - 楽曲管理画面の統合
  - ナビゲーション機能の追加
  - レスポンシブデザインの調整
  - アクセシビリティの向上
  - _Requirements: 11.1, 12.1_

- [x] 26. GitHub Pages対応の最終調整

  - ビルド設定の確認と最適化
  - 新機能のモバイル対応確認
  - パフォーマンステストの実行
  - デプロイ前の最終チェック
  - _Requirements: 9.1, 9.2, 9.3, 9.4_

- [x] 27. モバイルパフォーマンス強化とチラつき防止






  - MobilePerformanceManagerクラスの実装
  - GPU加速とレイヤー分離によるチラつき防止機能
  - ダイアログ表示中のアニメーション制御システム
  - 独立したレンダリングレイヤーによるダイアログ保護機能
  - CSS最適化によるflicker prevention strategyの実装
  - _Requirements: 18.1, 18.2, 18.3, 18.4, 18.5_

- [x] 28. 役割別シャボン玉システムの実装






  - RoleBasedBubbleManagerクラスの実装
  - 同一人物の複数役割に対する一意シャボン玉生成機能
  - カテゴリ別色分けシステムの実装
  - ColorLegendComponentの作成と表示機能
  - 重複防止ロジックの強化
  - _Requirements: 19.1, 19.2, 19.3, 19.4, 19.5_

- [x] 29. ランダム消失アニメーションシステムの実装






  - AdvancedAnimationControllerクラスの実装
  - ランダムな消失タイミング制御機能
  - 設定可能なアニメーションパラメータシステム
  - NaturalAnimationManagerによる自然な消失パターン
  - まばらな消失アニメーションの実装
  - _Requirements: 20.1, 20.2, 20.3, 20.4, 20.5_

- [x] 30. タグ一覧表示機能の実装






  - EnhancedTagListComponentの作成
  - タグ一覧画面のUI実装
  - タグ検索・ソート機能の実装
  - タグクリック時の楽曲一覧表示機能
  - モバイル最適化レイアウトの実装
  - _Requirements: 21.1, 21.2, 21.3, 21.4, 21.5_

- [x] 31. モバイルファーストUI改善






  - ヘッダーの簡素化とサイズ縮小
  - アイコンベースナビゲーションシステムの実装
  - シャボン玉領域の最大化
  - ハンバーガーメニューからアイコンボタンへの変更
  - タッチ操作最適化の強化
  - _Requirements: 17.1, 17.2, 17.3, 17.4, 17.5_

- [x] 32. 段階的テストと品質保証







  - 各修正完了後の部分的テスト実行
  - モバイルダイアログ修正後のダイアログ安定性テスト
  - Firebase復旧後のデータベース接続テスト
  - ローカルストレージ排除後のデータ永続化テスト
  - UI改善後のレスポンシブ動作テスト
  - _Requirements: 18.1, 19.1, 20.1, 21.1_

- [ ]* 32.1 新機能のユニットテスト

  - MobilePerformanceManagerのテスト
  - RoleBasedBubbleManagerのテスト
  - AdvancedAnimationControllerのテスト
  - EnhancedTagListComponentのテスト
  - _Requirements: 18.1, 19.1, 20.1, 21.1_
- [x] 34. 重要バグ修正とデグレード対応





  - モバイルダイアログ表示問題の修正（クリック時の正常表示）
  - Firebaseデータベース接続の復旧（楽曲登録・編集・削除のDB保存）
  - ローカルストレージの完全排除（Firebaseのみ使用）
  - PC/モバイル表示動作の統一
  - シャボン玉領域統計情報の削除
  - エラーハンドリングの改善（具体的なエラーメッセージ表示）
  - _Requirements: 1.1, 2.1, 3.1, 4.1, 5.1, 6.1_

- [x] 34.1 モバイルダイアログ表示の修正



  - タッチイベントハンドリングの改善
  - 長押し不要でのダイアログ表示実装
  - モバイル専用のイベントリスナー最適化
  - ダイアログ表示の一貫性確保
  - _Requirements: 1.1, 1.2, 1.3, 1.4_

- [x] 34.2 Firebaseデータベース統合の復旧



  - Firebase接続設定の確認と修正
  - 楽曲CRUD操作のFirebase保存実装
  - データベース操作エラーハンドリングの強化
  - 接続状態の監視と表示機能
  - _Requirements: 2.1, 2.2, 2.3, 2.4, 2.5, 2.6_

- [x] 34.3 ローカルストレージの完全排除



  - 既存ローカルストレージデータのクリア処理
  - DataManagerのローカルストレージ依存削除
  - Firebase専用データ管理への移行
  - データ取得・保存ロジックの統一
  - _Requirements: 3.1, 3.2, 3.3, 3.4, 3.5_

- [x] 34.4 表示動作の統一とUI改善



  - PC/モバイル間の表示動作統一
  - シャボン玉領域統計情報の削除
  - レスポンシブデザインの最適化のみ維持
  - 不要なUI要素の除去
  - _Requirements: 4.1, 4.2, 4.3, 4.4, 4.5, 5.1, 5.2, 5.3, 5.4_

- [x] 34.5 エラーハンドリングとユーザーフィードバック改善



  - 具体的なエラーメッセージの実装
  - Firebase接続エラーの詳細表示
  - 削除操作失敗時の適切なエラー表示
  - ネットワーク状態の監視と通知
  - _Requirements: 6.1, 6.2, 6.3, 6.4, 6.5_

- [x] 35. 最終統合テストと総合検証





  - 全修正機能の統合テスト
  - モバイル・PC両環境での総合動作確認
  - Firebase接続とデータ永続化の最終確認
  - 既存機能の後退がないことの検証
  - GitHub Pagesでのデプロイテスト
  - ユーザビリティ改善の総合評価
  - スマートフォンでの総合動作確認
  - _Requirements: 7.1, 7.2, 7.3, 7.4, 7.5, 7.6, 17.1, 18.1, 19.1, 20.1, 21.1_